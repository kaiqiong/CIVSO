% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/engines_full_moment_dMAR.R
\name{.estimate_block_gls_h2}
\alias{.estimate_block_gls_h2}
\title{Internal Engine: Full-Moment GLS (Block-wise)}
\usage{
.estimate_block_gls_h2(beta, se, R, n_total, n_samp, h_init, v_init)
}
\arguments{
\item{beta}{Vector of effect sizes for the block (length M_b).}

\item{se}{Vector of standard errors for the block.}

\item{R}{The LD correlation matrix for the block (M_b x M_b).}

\item{n_total}{Total number of SNPs in the FULL genome (M_global).}

\item{n_samp}{Sample size (N).}

\item{h_init}{Initial heritability estimate (from Diagonal WLS Step 1).}

\item{v_init}{Initial intercept estimate (from Diagonal WLS Step 1).}
}
\value{
A list containing the numerator and denominator scalars for this block.
}
\description{
Implements Formulation 2 (GLS) for a SINGLE LD block.
Calculates the components required for the global summation:
Numerator = A' * Omega_inv * M
Denominator = A' * Omega_inv * A
}
\keyword{internal}
