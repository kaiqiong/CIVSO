% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/engines_diagonal_dMAR.R
\name{.estimate_h2_struct}
\alias{.estimate_h2_struct}
\title{Internal Engine: Estimate Single-Trait Heritability Structure (Optimized)}
\usage{
.estimate_h2_struct(beta, se, ld_score, n_snp, n_samp, idx_subset = NULL)
}
\arguments{
\item{beta}{Vector of GWAS effect sizes}

\item{se}{Vector of standard errors}

\item{ld_score}{Vector of LD scores}

\item{n_snp}{Total number of SNPs (M)}

\item{n_samp}{Sample size (N)}
}
\value{
A list containing the slope (h2), intercept, and total expected squared moments.
}
\description{
Performs Two-Step WLS to estimate heritability from summary statistics.
Uses vectorized linear algebra (solving for slope through origin)
instead of lm() for maximum computational speed.
}
\keyword{internal}
