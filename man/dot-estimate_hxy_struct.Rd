% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/engines_diagonal_dMAR.R
\name{.estimate_hxy_struct}
\alias{.estimate_hxy_struct}
\title{Internal Engine: Estimate Cross-Trait Covariance Structure (Optimized)}
\usage{
.estimate_hxy_struct(
  betaX,
  betaY,
  res_XX,
  res_YY,
  ld_score,
  covXY_theory,
  n_snp,
  n_x,
  n_y,
  overlap_prop,
  idx_subset = NULL
)
}
\arguments{
\item{betaX}{Vector of GWAS effect sizes for Trait 1.}

\item{betaY}{Vector of GWAS effect sizes for Trait 2.}

\item{res_XX}{List output from .estimate_h2_struct for Trait 1. Must contain element `$E_total_sq`, i.e the expected squared moments}

\item{res_YY}{List output from .estimate_h2_struct for Trait 2. Contains expected squared moments ($E_Gamma_j_sq) needed for weighting.}

\item{ld_score}{Vector of LD scores (l_j).}

\item{covXY_theory}{Numeric scalar. The theoretical/phenotypic covariance between the traits (often estimated via intercept of initial regression or supplied externally).}

\item{n_snp}{Integer. Total number of SNPs (M) in the reference panel.}

\item{n_x}{Integer. Sample size for Trait 1 GWAS.}

\item{n_y}{Integer. Sample size for Trait 2 GWAS.}

\item{overlap_prop}{Numeric (0-1). Proportion of sample overlap between the two GWAS (N_overlap / N_total).}
}
\value{
A list containing the slope (h_xy), intercept, and fit details.
}
\description{
Performs Two-Step WLS to estimate genetic covariance.
Requires output from the single-trait engine (.estimate_h2_struct)
to calculate the correct Isserlis weights.
}
\keyword{internal}
